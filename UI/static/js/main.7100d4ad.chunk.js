(this["webpackJsonpfirewall-ui"]=this["webpackJsonpfirewall-ui"]||[]).push([[0],{437:function(e,t,n){},538:function(e,t,n){"use strict";n.r(t);var a,i,s,r,c=n(0),o=n.n(c),l=n(56),d=n.n(l),u=n(38),h=n(39),j=n(41),p=n(40),b=n(541),m=n(418),f=n(116),O=n(84),x=n(195),g=n(104),v=n(286),y=n(550),_=(n(436),n(437),["title","titleId"]);function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function S(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function C(e,t){var n=e.title,o=e.titleId,l=S(e,_);return c.createElement("svg",I({xmlns:"http://www.w3.org/2000/svg",width:71,height:71,viewBox:"0 0 71 71",ref:t,"aria-labelledby":o},l),n?c.createElement("title",{id:o},n):null,a||(a=c.createElement("style",null,".a{fill:none;stroke-width:3;}")),i||(i=c.createElement("path",{d:"m12.2 1.7h8.6c5.7 0 10.3 4.4 10.3 9.9v9.4c0 2.7 0 9.9 0 9.9 0 0-7.5 0-10.3 0h-8.6C6.1 30.7 1.5 26.3 1.5 20.8v-9.4c0-2.7 0.1-9.8 0.1-9.8 0 0 7.4-0.1 10.2-0.1z",className:"a"})),s||(s=c.createElement("path",{d:"m59.5 1.7h-8.6c-5.7 0-10.3 4.4-10.3 9.9v9.4c0 2.7 0 9.9 0 9.9 0 0 7.5 0 10.3 0H59.1c5.7 0 10.3-4.4 10.3-9.9v-9.4c0-2.7-0.1-9.8-0.1-9.8 0 0-7.4-0.1-10.2-0.1z",className:"a"})),r||(r=c.createElement("path",{d:"m12.2 69.6h8.6c5.7 0 10.3-4.4 10.3-9.9v-9.4c0-2.7 0-9.9 0-9.9 0 0-7.5 0-10.3 0h-8.6c-5.7 0-10.3 4.4-10.3 9.9v9.4c0 2.7 0.1 9.8 0.1 9.8 0 0 7.4 0.1 10.2 0.1z",className:"a"})),c.createElement("path",{d:"m31.2 30.9v9.4a8.2 8.2 0 0 0 1.2 0.1 8.2 8.2 0 0 0 8.2-8.2 8.2 8.2 0 0 0-0.1-1.3z",style:{fill:"none",strokeLinejoin:"round",strokeWidth:3}}))}var k=c.forwardRef(C),w=(n.p,n(571)),R=n(572),D=n(573),A=n(110),F=n(65),P=n(554),T=n(548),M=n(542),N=n(544),q=n(545),V=n(546),E=window.sessionStorage.getItem("user_info"),B=document.getElementById("api_url").getAttribute("value"),L={domain:-1===B.indexOf("{{")?B:"http://10.10.4.3:8000",userData:E?JSON.parse(E):null};function U(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("0"===e||isNaN(e)||void 0===e||0===e)return"0";var n=1024,a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n)),s=(e/Math.pow(n,i)).toFixed(2);return t?s+" "+a[i]:s}function z(e){var t=parseInt(e),n=0,a=0,i=0;return t>=86400&&(n=Math.floor(t/86400),t%=86400),t>=3600&&(a=Math.floor(t/3600),t%=3600),t>=60&&(i=Math.floor(t/60),t%=60),"".concat(n," days ").concat(a," hours ").concat(i," minute ").concat(t," seconds")}var H=n(25),G=n.n(H),K=n(3),W=b.a.Content,J={field:{display:"inline-block",marginRight:10,textAlign:"right",width:100}},Y={height:180,outline:{border:4,distance:8},wave:{length:128}},Q={height:180,padding:4,range:{ticks:[0,1],color:["l(0) 0:#F4664A 0.5:#FAAD14 1:#30BF78"]},indicator:{pointer:{style:{stroke:"#D0D0D0"}},pin:{style:{stroke:"#D0D0D0"}}},statistic:{content:{offsetY:5,style:{fontSize:"22px",color:"#4B535E"}}}},Z={height:220,angleField:"value",colorField:"name",radius:1,innerRadius:.8,label:{type:"outer"},interactions:[{type:"element-active"},{type:"element-selected"}]},X={padding:10,height:220,angleField:"hits",colorField:"host",radius:1,label:{type:"outer"}},$={xField:"date",yField:"value",height:220,margin:10,color:["#1979C9","#D62A0D","#FAA219"]},ee=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).ajaxGetData=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=G.a.get(L.domain+"/api/serverInfo/disk_usage").then((function(e){return a.setState({disk_util:e.data.data.util})})),n=G.a.get(L.domain+"/api/serverInfo/hostSessionCount").then((function(e){return a.setState({session_count:e.data.data})})),i=G.a.get(L.domain+"/api/serverInfo/sar/load",{params:{time_range:e?"10m":"5s"}}).then((function(t){var n=e?[]:a.state.loadData;t.data.data.map((function(e){return n.unshift({date:e.datetime,category:"load1",value:e.load1}),n.unshift({date:e.datetime,category:"load5",value:e.load5}),n.unshift({date:e.datetime,category:"load15",value:e.load15}),!1})),a.setState({loadData:n})})),s=G.a.get(L.domain+"/api/serverInfo/sar/tcp",{params:{time_range:e?"30m":"5s"}}).then((function(t){var n=e?[]:a.state.tcp_session;t.data.data.map((function(e){return n.unshift({date:e.datetime,category:"tcp_active",value:e.tcp_active/1e4}),n.unshift({date:e.datetime,category:"tcp_passive",value:e.tcp_passive/1e4}),!1})),a.setState({tcp_session:n})})),r=G.a.get(L.domain+"/api/serverInfo/sar/net",{params:{time_range:e?"10m":"5s"}}).then((function(t){var n=e?[]:a.state.inData,i=e?[]:a.state.outData;t.data.data.map((function(e){return n.unshift({interface:e.interface,date:e.datetime,value:parseInt(e.in_bytes/1e4)}),i.unshift({interface:e.interface,date:e.datetime,value:parseInt(e.out_bytes/1e4)}),!1})),a.setState({inData:n,outData:i})})),c=G.a.get(L.domain+"/api/serverInfo/basicInfo").then((function(e){return a.setState({basicInfo:e.data.data})})),o=G.a.get(L.domain+"/api/serverInfo/sar/cpu").then((function(e){a.setState({cpu_util:e.data.data[0].cpu_util/100})})),l=G.a.get(L.domain+"/api/serverInfo/sar/memory").then((function(e){a.setState({mem_util:parseInt(e.data.data[0].mem_util)/100})})),d=G.a.get(L.domain+"/api/serverInfo/iptables/aggregation/chainRule").then((function(e){return a.setState({rule_aggr:e.data.data.rule,chain_aggr:e.data.data.chain})}));Promise.all([i,r,c,o,l,s,d,t,n]).catch((function(e){console.log(e)}))},a.timer=null,a.state={loadData:[],inData:[],outData:[],basicInfo:{},cpu_util:0,mem_util:0,disk_util:0,tcp_session:[],rule_aggr:[],chain_aggr:[],session_count:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.ajaxGetData()}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return Object(K.jsxs)(o.a.Fragment,{children:[Object(K.jsxs)(P.a,{style:{margin:"16px 0"},children:[Object(K.jsx)(P.a.Item,{children:"Home"}),Object(K.jsx)(P.a.Item,{children:"Dashboard"})]}),Object(K.jsx)(b.a,{className:"site-layout-background",style:{padding:"24px 0"},children:Object(K.jsx)(W,{children:Object(K.jsxs)(x.a,{gutter:[8,8],children:[Object(K.jsx)(g.a,{span:6,children:Object(K.jsxs)(T.a,{title:"Host Information",children:[Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:J.field,children:"hostname"}),this.state.basicInfo.hostname]}),Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:J.field,children:"uptime"}),z(this.state.basicInfo.running_total_time)]}),Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:J.field,children:"sys time"}),new Date(1e3*this.state.basicInfo.system_time).toDateString()]}),Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:J.field,children:"cpu core"}),this.state.basicInfo.cpu_count]}),Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:J.field,children:"memory total"}),U(this.state.basicInfo.mem_total)]})]})}),Object(K.jsx)(g.a,{span:6,children:Object(K.jsx)(T.a,{title:"Cpu Utilization",children:Object(K.jsx)(M.a,Object(F.a)(Object(F.a)({},Q),{},{percent:this.state.cpu_util}))})}),Object(K.jsx)(g.a,{span:6,children:Object(K.jsx)(T.a,{title:"Memory Utilization",children:Object(K.jsx)(N.a,Object(F.a)(Object(F.a)({},Y),{},{percent:this.state.mem_util}))})}),Object(K.jsx)(g.a,{span:6,children:Object(K.jsx)(T.a,{title:"Disk Utilization",children:Object(K.jsx)(N.a,Object(F.a)(Object(F.a)({},Y),{},{theme:{styleSheet:{brandColor:"#FAAD14"}},percent:this.state.disk_util}))})}),Object(K.jsx)(g.a,{span:8,children:Object(K.jsx)(T.a,{title:"Rule Count",children:Object(K.jsx)(q.a,Object(F.a)(Object(F.a)({},Z),{},{data:this.state.rule_aggr}))})}),Object(K.jsx)(g.a,{span:8,children:Object(K.jsx)(T.a,{title:"Policy Count",children:Object(K.jsx)(q.a,Object(F.a)(Object(F.a)({},Z),{},{data:this.state.chain_aggr}))})}),Object(K.jsx)(g.a,{span:8,children:Object(K.jsx)(T.a,{title:"Session Count",children:Object(K.jsx)(q.a,Object(F.a)(Object(F.a)({},X),{},{data:this.state.session_count}))})}),Object(K.jsx)(g.a,{span:8,children:Object(K.jsx)(T.a,{title:"System Load",children:Object(K.jsx)(V.a,Object(F.a)({smooth:!1,data:this.state.loadData,seriesField:"category"},$))})}),Object(K.jsx)(g.a,{span:8,children:Object(K.jsx)(T.a,{title:"In traffic",children:Object(K.jsx)(V.a,Object(F.a)({data:this.state.inData,seriesField:"interface",smooth:!1,tooltip:{formatter:function(e){return{name:e.interface,value:U(e.value)}}},yAxis:{label:{formatter:function(e){return U(e)}}}},$))})}),Object(K.jsx)(g.a,{span:8,children:Object(K.jsx)(T.a,{title:"Out traffic",children:Object(K.jsx)(V.a,Object(F.a)({tooltip:{formatter:function(e){return{name:e.interface,value:U(e.value)}}},smooth:!1,data:this.state.outData,seriesField:"interface",yAxis:{label:{formatter:function(e){return U(e)}}}},$))})}),Object(K.jsx)(g.a,{span:24,children:Object(K.jsx)(T.a,{title:"Tcp Session",children:Object(K.jsx)(V.a,Object(F.a)({smooth:!1,data:this.state.tcp_session,seriesField:"category"},$))})})]})})})]})}}]),n}(c.Component),te=n(560),ne=n(561),ae=n(562),ie=n(563),se=n(564),re=n(565),ce=n(214),oe=n(549),le=n(288),de=n(412),ue=n(553),he=n(547),je=n(555),pe=n(557),be=n(558),me=n(419),fe=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={option_list:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;G.a.get(L.domain+"/api/serverInfo/interface/getInterfaceList").then((function(t){e.setState({option_list:t.data.data})}))}},{key:"render",value:function(){var e=this;return Object(K.jsx)(ce.a,{placeholder:"Select a interface",onChange:this.props.onChange,allowClear:!0,children:this.state.option_list.map((function(t,n){return"up"===t.state.toLowerCase()?Object(K.jsx)(ce.a.Option,{value:"index"===e.props.type?t.index:t.ifname,children:t.ifname},"item_"+n):null}))})}}]),n}(c.Component),Oe=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).onSubmit=function(){a.formRef.current.submit()},a.onFinish=function(e){if(void 0===a.props.ifname)return!1;var t=L.domain+"/api/config/ipRoute/setIpAddress";G.a.post(t,{ifname:a.props.ifname,ip:e.ip,netmask:e.netmask,mode:e.mode,state:e.state}).then((function(){m.b.success("success"),a.props.done()})).catch((function(e){m.b.error(e.response.data.detail)}))},a.handleModeChange=function(e){"none"===e.target.value&&(a.formRef.current.setFieldsValue({ip:"127.0.0.1",netmask:"255.255.255.0"}),a.setState({inputDisable:!0})),"static"===e.target.value&&a.setState({inputDisable:!1})},a.formRef=o.a.createRef(),a.state={inputDisable:!1},a}return Object(h.a)(n,[{key:"render",value:function(){return Object(K.jsxs)(oe.a,{layout:"vertical",name:"editInterface",onFinish:this.onFinish,initialValues:{ip:this.props.address,netmask:this.props.netmask,mode:"static",state:this.props.state},ref:this.formRef,children:[Object(K.jsx)(oe.a.Item,{label:"Mode",name:"mode",children:Object(K.jsxs)(le.a.Group,{onChange:this.handleModeChange,children:[Object(K.jsx)(le.a,{value:"static",defaultChecked:!0,children:"Static"}),Object(K.jsx)(le.a,{value:"none",children:"None"})]})}),Object(K.jsx)(oe.a.Item,{label:"Address",name:"ip",rules:[{required:!0,message:"please input ip address!"}],children:Object(K.jsx)(de.a,{disabled:this.state.inputDisable,placeholder:"ip address"})}),Object(K.jsx)(oe.a.Item,{label:"NetMask",name:"netmask",rules:[{required:!0,message:"please input netmask!"}],children:Object(K.jsx)(de.a,{disabled:this.state.inputDisable,placeholder:"netmask"})}),Object(K.jsx)(oe.a.Item,{label:"State",name:"state",children:Object(K.jsxs)(le.a.Group,{children:[Object(K.jsx)(le.a,{value:"up",children:"Up"}),Object(K.jsx)(le.a,{value:"down",children:"Down"})]})})]})}}]),n}(c.Component),xe=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).onSubmit=function(){a.formRef.current.submit()},a.onFinish=function(e){var t=L.domain+"/api/config/ipRoute/setRoute";G.a.post(t,e).then((function(e){m.b.success("success"),a.props.done()})).catch((function(e){m.b.error(e.response.data.detail)}))},a.formRef=o.a.createRef(),a}return Object(h.a)(n,[{key:"render",value:function(){return Object(K.jsxs)(oe.a,{layout:"vertical",name:"insertStaticRoute",onFinish:this.onFinish,ref:this.formRef,children:[Object(K.jsx)(oe.a.Item,{label:"Destination network",name:"dst",rules:[{required:!0,message:"please input destination network!",max:18}],children:Object(K.jsx)(de.a,{placeholder:"192.168.10.0/22"})}),Object(K.jsx)(oe.a.Item,{label:"Gateway",name:"gateway",rules:[{required:!0,message:"please input netmask!",max:15}],children:Object(K.jsx)(de.a,{placeholder:"192.168.10.1"})})]})}}]),n}(c.Component),ge=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).columns=[{title:"Interface Name",dataIndex:"ifname"},{title:"Address",dataIndex:"address"},{title:"Netmask",dataIndex:"netmask"},{title:"MAC",dataIndex:"mac"},{title:"Mtu",dataIndex:"mtu"},{title:"State",dataIndex:"state",render:function(e){return"up"===e.toLowerCase()?Object(K.jsx)(ue.a,{status:"success",text:"up"}):Object(K.jsx)(ue.a,{status:"error",text:"down"})}},{title:"Action",dataIndex:"index",render:function(e,t){return Object(K.jsx)(O.a,{disabled:0===t.ifname.indexOf("tun"),icon:Object(K.jsx)(pe.a,{}),onClick:function(){return a.handleEditInterfaceAddress(t)},children:"Modify"})}}],a.subComponentDone=function(){a.setState({visible:!1}),a.getAllInterfaces()},a.getAllInterfaces=function(){G.a.get(L.domain+"/api/serverInfo/interface/getInterfaceDetail").then((function(e){a.setState({dataSource:e.data.data})}))},a.handleEditInterfaceAddress=function(e){a.setState({visible:!0,modal_title:"Modify "+e.ifname+" interface  address",modal_content:Object(K.jsx)(Oe,{state:e.state,done:a.subComponentDone,address:e.address,ifname:e.ifname,netmask:e.netmask,ref:a.Child})})},a.onOk=function(){a.Child.current.onSubmit()},a.onCancel=function(){a.setState({visible:!1,modal_content:null})},a.Child=o.a.createRef(),a.state={dataSource:[],modal_content:null,modal_title:null,visible:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getAllInterfaces()}},{key:"render",value:function(){return Object(K.jsxs)(T.a,{title:"Interfaces",children:[Object(K.jsx)(he.a,{pagination:!1,dataSource:this.state.dataSource,columns:this.columns,rowKey:function(e){return e.index}}),Object(K.jsx)(y.a,{destroyOnClose:!0,title:this.state.modal_title,visible:this.state.visible,onOk:this.onOk,onCancel:this.onCancel,children:this.state.modal_content})]})}}]),n}(c.Component),ve=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).columns=[{title:"Destination",dataIndex:"dst"},{title:"Netmask",dataIndex:"dst_mask"},{title:"Gateway",dataIndex:"gateway"},{title:"Interface",dataIndex:"oif"},{title:"Action",dataIndex:"index",render:function(e,t){return Object(K.jsx)(O.a,{icon:Object(K.jsx)(be.a,{}),onClick:function(){return y.a.confirm({title:"delete static route",content:"deleting route",okType:"danger",onOk:function(){return a.handleDeleteRoute(t)}})},children:"Delete"})}}],a.subComponentDone=function(){a.setState({visible:!1}),a.getAllStaticRoute()},a.handleDeleteRoute=function(e){var t={dst:e.dst,gateway:e.gateway,dev:e.oif};G.a.delete(L.domain+"/api/config/ipRoute/setRoute",{data:t}).then((function(e){m.b.success("success"),a.getAllStaticRoute()})).catch((function(e){m.b.error(e.response.data.detail)}))},a.getAllStaticRoute=function(){G.a.get(L.domain+"/api/serverInfo/ipRoute/getStaticRouteTable").then((function(e){a.setState({dataSource:e.data.data})}))},a.onOk=function(){a.Child.current.onSubmit()},a.onCancel=function(){a.setState({visible:!1})},a.handleAddStaticRoute=function(){a.setState({modal_content:Object(K.jsx)(xe,{done:a.subComponentDone,ref:a.Child}),modal_title:"Add Static Route",visible:!0})},a.Child=o.a.createRef(),a.state={dataSource:[],modal_content:null,modal_title:null,visible:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getAllStaticRoute()}},{key:"render",value:function(){return Object(K.jsxs)(T.a,{title:"Static Route",children:[Object(K.jsxs)(je.b,{direction:"vertical",size:"middle",style:{width:"100%"},children:[Object(K.jsx)(O.a,{type:"primary",icon:Object(K.jsx)(me.a,{}),onClick:this.handleAddStaticRoute,children:"Add Static Route"}),Object(K.jsx)(he.a,{pagination:!1,dataSource:this.state.dataSource,columns:this.columns,rowKey:function(e){return e.idx}})]}),Object(K.jsx)(y.a,{destroyOnClose:!0,title:this.state.modal_title,visible:this.state.visible,onOk:this.onOk,onCancel:this.onCancel,children:this.state.modal_content})]})}}]),n}(c.Component),ye=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).getAllPolicyRoute=function(){G.a.get(L.domain+"/api/serverInfo/ipRoute/getAllIpRule").then((function(e){a.setState({dataSource:e.data.data})}))},a.deletePolicyRoute=function(e){for(var t in e)void 0!==e[t]&&null!==e[t]||delete e[t];G.a.delete(L.domain+"/api/config/ipRoute/setRule",{data:e}).then((function(){m.b.success("success"),a.getAllPolicyRoute()})).catch((function(e){m.b.error(e.response.data.detail)}))},a.onFinish=function(e){void 0===e.sport&&delete e.sport,void 0===e.dport&&delete e.dport,G.a.post(L.domain+"/api/config/ipRoute/setRule",e).then((function(){m.b.success("success"),a.setState({visible:!1}),a.getAllPolicyRoute()})).catch((function(e){m.b.error(e.response.data.detail)}))},a.columns=[{title:"Source",children:[{title:"Address",dataIndex:"src"},{title:"Port",dataIndex:"sport"}]},{title:"Destination",children:[{title:"Address",dataIndex:"dst"},{title:"Port",dataIndex:"dport"}]},{title:"Incoming Interface",dataIndex:"iif"},{title:"Protocol",dataIndex:"protocol"},{title:"Mark",dataIndex:"mark"},{title:"Out Interface",dataIndex:"oif"},{title:"Action",dataIndex:"idx",render:function(e,t){return Object(K.jsx)(O.a,{icon:Object(K.jsx)(be.a,{}),onClick:function(){y.a.confirm({title:"Delete policy route",onOk:function(){return a.deletePolicyRoute(t)},okType:"warning"})},children:"Delete"})}}],a.formRef=o.a.createRef(),a.state={dataSource:[],visible:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getAllPolicyRoute()}},{key:"render",value:function(){var e=this;return Object(K.jsxs)(T.a,{title:"Policy Route Table",children:[Object(K.jsxs)(je.b,{direction:"vertical",size:"middle",style:{width:"100%"},children:[Object(K.jsx)(O.a,{type:"primary",icon:Object(K.jsx)(me.a,{}),onClick:function(){return e.setState({visible:!0})},children:"Add Policy Route"}),Object(K.jsx)(he.a,{pagination:!1,dataSource:this.state.dataSource,columns:this.columns,rowKey:function(e){return e.id}})]}),Object(K.jsx)(y.a,{destroyOnClose:!0,title:"add policy route",visible:this.state.visible,onOk:function(){return e.formRef.current.submit()},onCancel:function(){return e.setState({visible:!1})},children:Object(K.jsxs)(oe.a,{layout:"vertical",ref:this.formRef,onFinish:this.onFinish,children:[Object(K.jsxs)(x.a,{gutter:10,children:[Object(K.jsx)(g.a,{span:12,children:Object(K.jsx)(oe.a.Item,{name:"src",label:"Source",rules:[{required:!0,message:"please input source addr",max:18}],children:Object(K.jsx)(de.a,{placeholder:"172.16.10.0/24"})})}),Object(K.jsx)(g.a,{span:12,children:Object(K.jsx)(oe.a.Item,{name:"sport",label:"Port",children:Object(K.jsx)(de.a,{max:65535,min:1,type:"number",placeholder:"80",onChange:function(t){return e.formRef.current.setFieldsValue({sport:parseInt(t.target.value)})}})})})]}),Object(K.jsx)(oe.a.Item,{name:"iif",label:"Input Interface",rules:[{required:!0,message:"please choice input interface",max:50}],children:Object(K.jsx)(fe,{onChange:function(t){return e.formRef.current.setFieldsValue({iif:t})}})}),Object(K.jsxs)(x.a,{gutter:10,children:[Object(K.jsx)(g.a,{span:12,children:Object(K.jsx)(oe.a.Item,{name:"dst",label:"Destination",rules:[{max:18,required:!0}],children:Object(K.jsx)(de.a,{placeholder:"172.16.20.0/24"})})}),Object(K.jsx)(g.a,{span:12,children:Object(K.jsx)(oe.a.Item,{name:"dport",label:"Port",children:Object(K.jsx)(de.a,{type:"number",min:1,max:65535,placeholder:8080,onChange:function(t){return e.formRef.current.setFieldsValue({dport:parseInt(t.target.value)})}})})})]}),Object(K.jsx)(oe.a.Item,{name:"protocol",label:"Protocol",children:Object(K.jsxs)(ce.a,{placeholder:"Select a protocol",allowClear:!0,onChange:function(t){return e.formRef.current.setFieldsValue({protocol:t})},children:[Object(K.jsx)(ce.a.Option,{value:"tcp",children:"TCP"}),Object(K.jsx)(ce.a.Option,{value:"udp",children:"UDP"}),Object(K.jsx)(ce.a.Option,{value:"icmp",children:"ICMP"}),Object(K.jsx)(ce.a.Option,{value:"gre",children:"GRE"}),Object(K.jsx)(ce.a.Option,{value:"ospf",children:"OSPF"}),Object(K.jsx)(ce.a.Option,{value:"ah",children:"AH"}),Object(K.jsx)(ce.a.Option,{value:"esp",children:"ESP"})]})}),Object(K.jsx)(x.a,{gutter:10,children:Object(K.jsx)(g.a,{span:24,children:Object(K.jsx)(oe.a.Item,{name:"mark",label:"Mark",rules:[{required:!0,message:"please input a mark"}],children:Object(K.jsx)(de.a,{type:"number",min:1,max:99,placeholder:"1",onChange:function(t){return e.formRef.current.setFieldsValue({mark:parseInt(t.target.value)})}})})})}),Object(K.jsx)(oe.a.Item,{name:"oif",label:"Output Interface",rules:[{required:!0,message:"please choice output interface",max:50}],children:Object(K.jsx)(fe,{onChange:function(t){return e.formRef.current.setFieldsValue({oif:t})}})})]})})]})}}]),n}(c.Component),_e=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).getArpData=function(){G.a.get(L.domain+"/api/serverInfo/arp").then((function(e){return a.setState({datasource:e.data.data})}))},a.columns=[{title:"Id",dataIndex:"id"},{title:"Ip Address",dataIndex:"ip_addr"},{title:"HW Address",dataIndex:"hw_addr"},{title:"Device",dataIndex:"device"}],a.state={datasource:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getArpData()}},{key:"render",value:function(){return Object(K.jsx)(T.a,{title:"Arp table",children:Object(K.jsx)(he.a,{columns:this.columns,pagination:!1,dataSource:this.state.datasource,rowKey:function(e){return e.id}})})}}]),n}(c.Component),Ie=n(420),Se=n(552),Ce=n(407),ke=n(295),we=n(559),Re=n(157),De=["className","style"];function Ae(e){var t={};for(var n in e)void 0!==e[n]&&null!==e[n]&&(t[n]=e[n]);return t}var Fe,Pe=Object(ke.c)((function(){return Object(K.jsx)(we.a,{style:{cursor:"grab",color:"#999"}})})),Te=Object(ke.b)((function(e){return Object(K.jsx)("tr",Object(F.a)({},e))})),Me=Object(ke.a)((function(e){return Object(K.jsx)("tbody",Object(F.a)({},e))})),Ne=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).onSubmit=function(){a.formRef.current.submit()},a.getCascaderData=function(){G.a.get(L.domain+"/api/config/vip/getVipAddress").then((function(e){return a.setState({cascaderData:e.data.data})}))},a.onFinish=function(e){if(e.to_source=a.formRef.current.getFieldValue("to_source"),void 0===a.props.chainName||null===a.props.chainName)return!1;var t={chain_name:a.props.chainName};for(var n in e)void 0===e[n]&&null===e[n]&&""===e[n].trim()||(t[n]=e[n]?e[n].replaceAll(" ",""):e[n]);G.a.post(L.domain+"/api/config/iptables/setRule/"+a.props.groupType,t).then((function(){m.b.success("success"),a.props.done()})).catch((function(e){return m.b.error(e.response.data.detail)}))},a.handleTargetChange=function(e){var t=a.state.visible;switch(t.to_ports=!1,t.to_source=!1,t.to_destination=!1,t.out_interface=!1,a.formRef.current.setFieldsValue({to_ports:void 0,to_source:void 0,to_destination:void 0,out_interface:void 0,target:e.toUpperCase()}),e){case"snat":t.to_source=!0,t.out_interface=!0;break;case"masquerade":t.out_interface=!0;break;case"dnat":t.to_destination=!0;break;case"redirect":t.to_ports=!0}a.setState({visible:t})},a.filter=function(e,t){return t.some((function(t){return t.label.toLowerCase().indexOf(e.toLowerCase())>-1}))},a.formRef=o.a.createRef(),a.state={visible:{to_source:!1,to_ports:!1,to_destination:!1,out_interface:!1},cascaderData:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getCascaderData()}},{key:"render",value:function(){var e=this;return Object(K.jsxs)(oe.a,{ref:this.formRef,name:"dynamic_form_item",layout:"vertical",onFinish:this.onFinish,children:[Object(K.jsx)(oe.a.Item,{name:"comment",label:"Comment",rules:[{message:"pleas input comment",max:18}],children:Object(K.jsx)(de.a,{placeholder:"comment"})}),Object(K.jsxs)(x.a,{gutter:10,children:[Object(K.jsx)(g.a,{span:12,children:Object(K.jsx)(oe.a.Item,{name:"src",label:"Source",rules:[{max:18}],children:Object(K.jsx)(de.a,{placeholder:"172.16.10.0/24"})})}),Object(K.jsx)(g.a,{span:12,children:Object(K.jsx)(oe.a.Item,{name:"sport",label:"Port",tooltip:"port or port:port or port1,port2",children:Object(K.jsx)(de.a,{max:1024,min:1,placeholder:80})})})]}),Object(K.jsx)(oe.a.Item,{name:"in_interface",label:"In Interface",rules:[{max:50}],children:Object(K.jsx)(fe,{onChange:function(t){return e.formRef.current.setFieldsValue({in_interface:t})}})}),Object(K.jsxs)(x.a,{gutter:10,children:[Object(K.jsx)(g.a,{span:12,children:Object(K.jsx)(oe.a.Item,{name:"dst",label:"Destination",rules:[{max:18}],children:Object(K.jsx)(de.a,{placeholder:"172.16.20.0/24"})})}),Object(K.jsx)(g.a,{span:12,children:Object(K.jsx)(oe.a.Item,{name:"dport",label:"Port",tooltip:"port or port:port or port1, port2",children:Object(K.jsx)(de.a,{max:1024,min:1,placeholder:8080})})})]}),Object(K.jsx)(oe.a.Item,{name:"protocol",label:"Protocol",children:Object(K.jsxs)(ce.a,{placeholder:"Select a protocol",allowClear:!0,onChange:function(t){return e.formRef.current.setFieldsValue({protocol:t})},children:[Object(K.jsx)(ce.a.Option,{value:"tcp",children:"TCP"}),Object(K.jsx)(ce.a.Option,{value:"udp",children:"UDP"}),Object(K.jsx)(ce.a.Option,{value:"icmp",children:"ICMP"})]})}),Object(K.jsx)(oe.a.Item,{name:"target",label:"Target",rules:[{required:!0,message:"please choice target",max:10}],children:Object(K.jsx)(ce.a,{placeholder:"Select a target",onChange:this.handleTargetChange,allowClear:!0,children:"snat"===this.props.groupType?Object(K.jsxs)(o.a.Fragment,{children:[Object(K.jsx)(ce.a.Option,{value:"snat",children:"SNAT"}),Object(K.jsx)(ce.a.Option,{value:"masquerade",children:"MASQUERADE"})]}):"dnat"===this.props.groupType?Object(K.jsxs)(o.a.Fragment,{children:[Object(K.jsx)(ce.a.Option,{value:"dnat",children:"DNAT"}),Object(K.jsx)(ce.a.Option,{value:"redirect",children:"REDIRECT"})]}):Object(K.jsxs)(o.a.Fragment,{children:[Object(K.jsx)(ce.a.Option,{value:"accept",children:"ACCEPT"}),Object(K.jsx)(ce.a.Option,{value:"drop",children:"DROP"})]})})}),Object(K.jsx)(oe.a.Item,{hidden:!this.state.visible.to_source,label:"To source",children:Object(K.jsx)(Se.a,{options:this.state.cascaderData,onChange:function(t){var n=t[1];e.formRef.current.setFieldsValue({to_source:n})},popupPlacement:"topLeft",placeholder:"192.168.10.1",showSearch:{filter:this.filter}})}),Object(K.jsx)(oe.a.Item,{hidden:!this.state.visible.out_interface,name:"out_interface",label:"Out Interface",rules:[{max:50}],children:Object(K.jsx)(fe,{onChange:function(t){return e.formRef.current.setFieldsValue({out_interface:t})}})}),Object(K.jsx)(oe.a.Item,{hidden:!this.state.visible.to_destination,name:"to_destination",label:"To destination",tooltip:"ip or ip:port or ip:port-port",rules:[{message:"pleas input to destination",max:200}],children:Object(K.jsx)(de.a,{placeholder:"10.10.4.1:80"})}),Object(K.jsx)(oe.a.Item,{hidden:!this.state.visible.to_ports,name:"to_ports",label:"To ports",children:Object(K.jsx)(de.a,{max:100,placeholder:"80"})})]})}}]),n}(c.Component),qe=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).onSubmit=function(){a.formRef.current.submit()},a.onFinish=function(e){if(void 0===a.props.groupType||-1===["snat","dnat","filter"].indexOf(a.props.groupType))return!1;var t=L.domain+"/api/config/iptables/setChainGroup";-1!==["snat","dnat"].indexOf(a.props.groupType)?e.table_name="nat":e.table_name="filter","filter"!==a.props.groupType&&(e.nat_mode=a.props.groupType),G.a.post(t,e).then((function(){m.b.success("success"),a.props.done()})).catch((function(e){m.b.error(e.response.data.detail)}))},a.formRef=o.a.createRef(),a}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return Object(K.jsxs)(oe.a,{layout:"vertical",name:"addChain",onFinish:this.onFinish,ref:this.formRef,initialValues:{src:"0.0.0.0/0",dst:"0.0.0.0/0"},children:[Object(K.jsx)(oe.a.Item,{label:"Name",name:"chain_name",rules:[{required:!0,message:"please input policy name",max:30}],children:Object(K.jsx)(de.a,{placeholder:"name"})}),"filter"===this.props.groupType?Object(K.jsx)(oe.a.Item,{name:"in_interface",label:"In Interface",rules:[{max:50}],children:Object(K.jsx)(fe,{onChange:function(t){return e.formRef.current.setFieldsValue({in_interface:t})}})}):null,Object(K.jsx)(oe.a.Item,{label:"Source address",name:"src",rules:[{required:!0,message:"please source address",max:18}],children:Object(K.jsx)(de.a,{placeholder:"0.0.0.0/0"})}),Object(K.jsx)(oe.a.Item,{label:"Destination address",name:"dst",rules:[{required:!0,message:"please destination address",max:18}],children:Object(K.jsx)(de.a,{placeholder:"0.0.0.0/0"})})]})}}]),n}(c.Component),Ve=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).columns=[{title:"Name",dataIndex:"chain_name",width:200,render:function(e,t){var n={color:t.manual?"gray":"black",textDecoration:t.manual?"line-through":"none"};return t.is_rule&&(n.color="red"),t.is_rule?Object(K.jsx)("span",{style:n,children:e}):Object(K.jsx)("a",{href:"#",title:e,style:n,onClick:function(){return a.getAllRulesByChain(t)},children:e})}},{title:"In Interface",dataIndex:"in_interface",render:function(e){return null===e?"*":e}},{title:"Source",dataIndex:"src"},{title:"Destination",dataIndex:"dst"},{title:"Counters",children:[{title:"Packets",dataIndex:"packets",render:function(e){return e}},{title:"Bytes",dataIndex:"bytes",render:function(e){return U(e)}}]},{title:"Action",dataIndex:"id",render:function(e,t){return Object(K.jsx)(je.b,{children:Object(K.jsx)(O.a,{disabled:t.is_rule,icon:Object(K.jsx)(be.a,{}),onClick:function(){return a.handleDeleteChain(t)},children:"Delete"})})}}],a.onSortEnd=function(e){var t=e.oldIndex,n=e.newIndex,i=a.state.dataSource,s=i[t].rule_seq,r=i[n].rule_seq;if(-1===s||-1===r)return y.a.info({title:"Warning",content:"some rule not enable"});t!==n&&G.a.put(L.domain+"/api/config/iptables/changeRule",{chain_name:a.state.chain_name,old_index:s,new_index:r}).then((function(){var e=Object(Ce.a)([].concat(i),t,n).filter((function(e){return!!e}));console.log("Sorted items: ",e),a.setState({dataSource:e})})).catch((function(e){return y.a.error({title:"error",content:e.response.data.detail})}))},a.DraggableContainer=function(e){return Object(K.jsx)(Me,Object(F.a)({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:a.onSortEnd},e))},a.DraggableBodyRow=function(e){e.className,e.style;var t=Object(Ie.a)(e,De),n=a.state.dataSource.findIndex((function(e){return e.id===t["data-row-key"]}));return Object(K.jsx)(Te,Object(F.a)({index:n},t))},a.ruleMoreMenu=function(e){return Object(K.jsxs)(f.a,{onClick:function(t){return a.handleRuleAction(t,e)},children:[Object(K.jsx)(f.a.Item,{children:1===e.enable?"Pause":"Resume"},1===e.enable?"pause":"resume"),Object(K.jsx)(f.a.Item,{children:"Delete"},"delete")]},"rule_menu")},a.ruleColumns=[{title:"Sort",dataIndex:"rule_seq",width:70,render:function(){return Object(K.jsx)(Pe,{})},fixed:"left"},{title:"Source",children:[{title:"addr",dataIndex:"src",width:180},{title:"port",dataIndex:"sport",width:130,render:function(e){return e?e.replaceAll(" ",""):null}}]},{title:"Destination",width:250,children:[{title:"addr",dataIndex:"dst",width:180},{title:"port",dataIndex:"dport",width:130,render:function(e){return e?e.replaceAll(" ",""):null}}]},{title:"Protocol",dataIndex:"protocol",width:95},{title:"In Interface",dataIndex:"in_interface",width:120},{title:"Target",children:[{title:"Action",dataIndex:"target",width:100},{title:"Out Interface",dataIndex:"out_interface",width:130},{title:"To Destination",dataIndex:"to_destination",width:150},{title:"To source",dataIndex:"to_source",width:150},{title:"To ports",dataIndex:"to_ports",width:150}]},{title:"Status",children:[{title:"State",dataIndex:"enable",width:105,render:function(e){return Object(K.jsx)(ue.a,{status:1===e?"processing":"error",text:1===e?"running":"disabled"})}},{title:"Packets",dataIndex:"packets",width:120},{title:"Bytes",dataIndex:"bytes",width:120,render:function(e){return U(e)}}]},{title:"Operate",dataIndex:"id",fixed:"right",width:100,render:function(e,t){return Object(K.jsx)(v.a,{disabled:a.state.disabled,overlay:a.ruleMoreMenu(t),trigger:["click"],children:Object(K.jsxs)("a",{children:["More ",Object(K.jsx)(A.a,{})]})})}}],a.handleRuleAction=function(e,t){var n=t.id>0?t.chain.chain_name:t.chain_name;switch(e.key.toLowerCase()){case"pause":t.enable=0,a.pauseAndResumeEvent(t);break;case"resume":t.enable=1,a.pauseAndResumeEvent(t);break;case"delete":y.a.confirm({title:"delete rule",content:"deleting rule from "+n,okType:"danger",onOk:function(){var e=Ae(t);e.chain_name=n,G.a.delete(L.domain+"/api/config/iptables/setRule/"+a.props.groupType,{data:e}).then((function(){m.b.success("success"),a.getAllRulesByChain({chain_name:a.state.chain_name})})).catch((function(e){return m.b.error(e.response.data.detail)}))}})}},a.pauseAndResumeEvent=function(e){var t=e.id>0?e.chain.chain_name:e.chain_name,n=Ae(e);n.chain_name=t,G.a.put(L.domain+"/api/config/iptables/setRule/"+a.props.groupType,n).then((function(){m.b.success("success"),a.getAllRulesByChain({chain_name:a.state.chain_name})})).catch((function(e){return m.b.error(e.response.data.detail)}))},a.getAllChains=function(e){if(-1===["snat","dnat","filter"].indexOf(e.groupType))return!1;G.a.get(L.domain+"/api/serverInfo/iptables/getAllChain",{params:{group_type:e.groupType}}).then((function(e){a.setState({dataSource:e.data.data,page_tag:"chain"})}))},a.onOk=function(){a.Child.current.onSubmit()},a.onCancel=function(){a.setState({visible:!1,modal_content:null})},a.getAllRulesByChain=function(e){var t="filter"===a.props.groupType?"filter":"nat";G.a.get(L.domain+"/api/serverInfo/iptables/getAllRulesByChain",{params:{chain_name:e.chain_name,table_name:t}}).then((function(t){a.setState({dataSource:t.data.data,page_tag:"rule",disabled:e.manual,chain_name:e.chain_name})}))},a.handleDeleteChain=function(e){for(var t in"nat"===e.table_name&&(e.nat_mode=e.group_type),e)null===e[t]&&delete e[t];y.a.confirm({title:"deleting policy",content:"delete policy will delete all relate rules",okType:"danger",onOk:function(){G.a.delete(L.domain+"/api/config/iptables/setChainGroup",{data:e}).then((function(){m.b.success("success"),a.getAllChains(a.props)})).catch((function(e){return m.b.error(e.response.data.detail)}))}})},a.subComponentDone=function(){a.setState({visible:!1}),"chain"===a.state.page_tag?a.getAllChains(a.props):a.getAllRulesByChain({chain_name:a.state.chain_name})},a.handleAddChainGroup=function(){a.setState({visible:!0,modal_content:Object(K.jsx)(qe,{done:a.subComponentDone,ref:a.Child,groupType:a.props.groupType}),modal_title:"Add "+a.props.groupType.toUpperCase()+" Policy"})},a.handleAddRule=function(e){var t=Object(K.jsx)(Ne,{done:a.subComponentDone,ref:a.Child,groupType:a.props.groupType,chainName:e});a.setState({visible:!0,modal_content:t,modal_title:"Add rule to "+e+" policy"})},a.Child=o.a.createRef(),a.ruleRecord=null,a.state={page_tag:"chain",chain_name:null,disabled:!1,dataSource:[],ruleData:[],groupType:a.props.groupType,modal_content:null,modal_title:null,visible:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getAllChains(this.props)}},{key:"componentDidUpdate",value:function(e,t,n){this.props.groupType!==e.groupType&&this.getAllChains(this.props)}},{key:"render",value:function(){var e=this;return Object(K.jsxs)(T.a,{title:this.props.titleName+" Policy",children:[Object(K.jsxs)(je.b,{style:{width:"100%"},direction:"vertical",size:"large",children:["chain"===this.state.page_tag?Object(K.jsx)(O.a,{type:"primary",icon:Object(K.jsx)(me.a,{}),onClick:this.handleAddChainGroup,children:"Add Policy"}):Object(K.jsxs)(je.b,{children:[Object(K.jsx)(O.a,{icon:Object(K.jsx)(Re.a,{}),onClick:function(){return e.getAllChains(e.props)},children:"Back"}),Object(K.jsx)(O.a,{icon:Object(K.jsx)(me.a,{}),disabled:this.state.disabled,onClick:function(){return e.handleAddRule(e.state.chain_name)},children:"Insert Rule"})]}),Object(K.jsx)(he.a,{pagination:!1,dataSource:this.state.dataSource,columns:"chain"===this.state.page_tag?this.columns:this.ruleColumns,rowKey:function(e){return e.id},scroll:{x:1300},components:"chain"===this.state.page_tag?{}:{body:{wrapper:this.DraggableContainer,row:this.DraggableBodyRow}}})]}),Object(K.jsx)(y.a,{destroyOnClose:!0,title:this.state.modal_title,visible:this.state.visible,onOk:this.onOk,onCancel:this.onCancel,children:this.state.modal_content})]})}}]),n}(c.Component),Ee=n(215),Be=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).getDataFromServer=function(){G.a.get(L.domain+"/api/config/sys/sysConfig").then((function(e){return a.setState({data:e.data.data})}))},a.handleSwitchChange=function(e,t){G.a.post(L.domain+"/api/config/sys/sysConfig",{item:e,value:t.target.checked}).then((function(){return a.getDataFromServer()})).catch((function(e){return m.b.error(e.response.data.detail)}))},a.state={data:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getDataFromServer()}},{key:"render",value:function(){var e=this;return Object(K.jsx)(T.a,{title:"System setting",children:this.state.data.map((function(t,n){return Object(K.jsx)("p",{children:Object(K.jsx)(Ee.a,{checked:t.value,onChange:function(n){return e.handleSwitchChange(t.item,n)},children:t.desc})},n)}))})}}]),n}(c.Component),Le=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).isp2cn=function(e){var t="";switch(e){case"china-mobile":t="\u79fb\u52a8";break;case"telecom":t="\u7535\u4fe1";break;case"unicom":t="\u8054\u901a";break;case"private":t="\u79c1\u6709";break;case"other":t="\u5176\u5b83"}return t},a.handleDeleteVip=function(e){return y.a.confirm({title:"delete vip pool",okType:"danger",onOk:function(){G.a.delete(L.domain+"/api/config/vip/setVip",{params:{id:e}}).then((function(e){m.b.success(e.data.msg),a.getAllRecord()}))}})},a.columns=[{title:"Name",dataIndex:"name"},{title:"Address Range",dataIndex:"ip_range",render:function(e){return e.replaceAll("-"," - ")}},{title:"ISP",dataIndex:"isp",render:function(e){return a.isp2cn(e)}},{title:"State",dataIndex:"state",render:function(e){return"e"===e.toLowerCase()?Object(K.jsx)(ue.a,{status:"success",text:"enable"}):Object(K.jsx)(ue.a,{status:"error",text:"disable"})}},{title:"Pub Date",dataIndex:"pub_date",render:function(e){return e.substr(0,16)}},{title:"Action",dataIndex:"id",render:function(e,t){return Object(K.jsxs)(je.b,{children:[Object(K.jsx)(O.a,{icon:Object(K.jsx)(pe.a,{}),onClick:function(){var e=t.ip_range.split("-");a.start_ip=e[0],a.end_ip=e[1],a.editData=t,a.setState({visible:!0})},children:"Edit"}),Object(K.jsx)(O.a,{icon:Object(K.jsx)(be.a,{}),onClick:function(){return a.handleDeleteVip(e)},children:"Delete"})]})}}],a.getAllRecord=function(){G.a.get(L.domain+"/api/config/vip/setVip").then((function(e){return a.setState({dataSource:e.data.data})}))},a.onFinish=function(e){var t,n=L.domain+"/api/config/vip/setVip";void 0!==a.editData.id&&a.editData.id>0?(n+="?id="+a.editData.id,t=G.a.put(n,e)):t=G.a.post(n,e),t.then((function(e){m.b.success(e.data.msg),a.getAllRecord(),a.setState({visible:!1})})).catch((function(e){return m.b.error(e.response.data.detail)}))},a.formRef=o.a.createRef(),a.start_ip="",a.end_ip="",a.editData={},a.state={dateSource:[],visible:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getAllRecord()}},{key:"render",value:function(){var e=this;return Object(K.jsxs)(T.a,{title:"Virtual Ip Pool",children:[Object(K.jsxs)(je.b,{direction:"vertical",size:"middle",style:{width:"100%"},children:[Object(K.jsx)(O.a,{type:"primary",icon:Object(K.jsx)(me.a,{}),onClick:function(){return e.setState({visible:!0})},children:"Add Ip Pool"}),Object(K.jsx)(he.a,{pagination:!1,dataSource:this.state.dataSource,columns:this.columns,rowKey:function(e){return e.id}})]}),Object(K.jsx)(y.a,{destroyOnClose:!0,title:"add virtual ip pool",visible:this.state.visible,onOk:function(){return e.formRef.current.submit()},onCancel:function(){e.start_ip="",e.end_ip="",e.setState({visible:!1}),e.editData={}},children:Object(K.jsxs)(oe.a,{ref:this.formRef,onFinish:this.onFinish,layout:"vertical",initialValues:this.editData,children:[Object(K.jsx)(oe.a.Item,{name:"name",label:"Name",rules:[{required:!0,max:20,message:"please input a name"}],children:Object(K.jsx)(de.a,{placeholder:"pool name",max:20})}),Object(K.jsx)(oe.a.Item,{name:"ip_range",label:"IP Range",rules:[{required:!0,message:"please input ip range",max:31}],children:Object(K.jsxs)(de.a.Group,{compact:!0,children:[Object(K.jsx)(de.a,{style:{textAlign:"center",width:"45%"},max:15,placeholder:"192.168.100.1",defaultValue:this.start_ip,onChange:function(t){e.start_ip=t.target.value,e.formRef.current.setFieldsValue({ip_range:e.start_ip+"-"+e.end_ip})}}),Object(K.jsx)(de.a,{style:{width:"10%",textAlign:"center",borderLeft:0,borderRight:0,pointerEvents:"none"},placeholder:"-",disabled:!0}),Object(K.jsx)(de.a,{max:15,className:"site-input-right",style:{width:"45%",textAlign:"center"},defaultValue:this.end_ip,placeholder:"192.168.100.10",onChange:function(t){e.end_ip=t.target.value,e.formRef.current.setFieldsValue({ip_range:e.start_ip+"-"+e.end_ip})}})]})}),Object(K.jsx)(oe.a.Item,{name:"isp",label:"Isp",rules:[{required:!0,message:"please choice a isp"}],children:Object(K.jsxs)(ce.a,{children:[Object(K.jsx)(ce.a.Option,{value:"telecom",children:"\u7535\u4fe1"}),Object(K.jsx)(ce.a.Option,{value:"unicom",children:"\u8054\u901a"}),Object(K.jsx)(ce.a.Option,{value:"china-mobile",children:"\u79fb\u52a8"}),Object(K.jsx)(ce.a.Option,{value:"private",children:"\u79c1\u6709"}),Object(K.jsx)(ce.a.Option,{value:"other",children:"\u5176\u5b83"})]})}),Object(K.jsx)(oe.a.Item,{name:"state",label:"State",rules:[{required:!0,message:"please choice a state"}],children:Object(K.jsxs)(le.a.Group,{buttonStyle:"solid",style:{width:"100%"},children:[Object(K.jsx)(le.a.Button,{value:"e",style:{width:"50%",textAlign:"center"},children:"Enable"}),Object(K.jsx)(le.a.Button,{value:"d",style:{width:"50%",textAlign:"center"},children:"Disable"})]})})]})})]})}}]),n}(c.Component),Ue=n(551),ze=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).handleAddHostToList=function(){a.setState({visible:!0})},a.onCancel=function(){a.setState({visible:!1})},a.onOk=function(){a.child.current.submit()},a.onFinish=function(e){G.a.post(L.domain+"/api/config/sys/ipset",e,{params:{type:a.props.type}}).then((function(e){m.b.success(e.data.msg),a.setState({visible:!1}),a.get_all_host_from_server()})).catch((function(e){return y.a.error({title:"error!",content:e.response.data.detail})}))},a.deleteIpSetRecord=function(e){G.a.delete(L.domain+"/api/config/sys/ipset",{params:{type:a.props.type},data:{ip:e.ip}}).then((function(e){m.b.success(e.data.msg),a.get_all_host_from_server()})).catch((function(e){return m.b.error(e.response.data.detail)}))},a.columns=[{title:"Id",dataIndex:"id"},{title:"Ip",dataIndex:"ip"},{title:"Timeout",dataIndex:"timeout"},{title:"Action",key:"action",render:function(e){return Object(K.jsx)(O.a,{icon:Object(K.jsx)(be.a,{}),onClick:function(){return a.deleteIpSetRecord(e)},children:"Delete"})}}],a.child=o.a.createRef(),a.state={dataSource:[],visible:!1},a}return Object(h.a)(n,[{key:"get_all_host_from_server",value:function(){var e=this;G.a.get(L.domain+"/api/config/sys/ipset",{params:{type:this.props.type}}).then((function(t){return e.setState({dataSource:t.data.data})}))}},{key:"componentDidMount",value:function(){this.get_all_host_from_server()}},{key:"componentDidUpdate",value:function(e,t,n){this.props.type!==e.type&&this.get_all_host_from_server()}},{key:"render",value:function(){var e=this;return Object(K.jsxs)(T.a,{title:this.props.title,children:[Object(K.jsxs)(je.b,{style:{width:"100%"},direction:"vertical",size:"large",children:[Object(K.jsx)(O.a,{type:"primary",icon:Object(K.jsx)(me.a,{}),onClick:this.handleAddHostToList,children:"Add Host"}),Object(K.jsx)(he.a,{pagination:!1,dataSource:this.state.dataSource,columns:this.columns,rowKey:function(e){return e.id}})]}),Object(K.jsx)(y.a,{destroyOnClose:!0,title:"Add host to "+this.props.title,visible:this.state.visible,onOk:this.onOk,onCancel:this.onCancel,children:Object(K.jsxs)(oe.a,{name:"form",layout:"vertical",ref:this.child,onFinish:this.onFinish,children:[Object(K.jsx)(oe.a.Item,{name:"ip",label:"Ip Address",rules:[{required:!0,message:"please input a correct ip address",max:18}],children:Object(K.jsx)(de.a,{placeholder:"10.10.10.1"})}),Object(K.jsx)(oe.a.Item,{name:"timeout",label:"Timeout",initialValue:0,children:Object(K.jsx)(Ue.a,{max:86400,min:0,onChange:function(t){return e.child.current.setFieldsValue({timeout:parseInt(t)})}})})]})})]})}}]),n}(c.Component),He=b.a.Sider,Ge=b.a.Content,Ke=f.a.SubMenu,We=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).handleMenuClick=function(e){switch(e.key){case"interfaces":a.setState({content:Object(K.jsx)(ge,{})});break;case"arp":a.setState({content:Object(K.jsx)(_e,{})});break;case"s_route":a.setState({content:Object(K.jsx)(ve,{})});break;case"vip":a.setState({content:Object(K.jsx)(Le,{})});break;case"p_route":a.setState({content:Object(K.jsx)(ye,{})});break;case"snat":a.setState({content:Object(K.jsx)(Ve,{titleName:"Nat",groupType:e.key})});break;case"dnat":a.setState({content:Object(K.jsx)(Ve,{titleName:"Port Map",groupType:e.key})});break;case"filter":a.setState({content:Object(K.jsx)(Ve,{titleName:"Forward",groupType:e.key})});break;case"system":a.setState({content:Object(K.jsx)(Be,{})});break;case"blacklist":a.setState({content:Object(K.jsx)(ze,{title:"Black List",type:"blacklist"})});break;case"whitelist":a.setState({content:Object(K.jsx)(ze,{title:"White List",type:"whitelist"})})}},a.state={content:Object(K.jsx)(ge,{})},a}return Object(h.a)(n,[{key:"render",value:function(){return Object(K.jsxs)(o.a.Fragment,{children:[Object(K.jsxs)(P.a,{style:{margin:"16px 0"},children:[Object(K.jsx)(P.a.Item,{children:"Home"}),Object(K.jsx)(P.a.Item,{children:"Config"})]}),Object(K.jsxs)(b.a,{className:"site-layout-background",style:{padding:"24px 0"},children:[Object(K.jsx)(He,{className:"site-layout-background",width:200,children:Object(K.jsxs)(f.a,{mode:"inline",defaultSelectedKeys:["interfaces"],style:{height:"100%"},onClick:this.handleMenuClick,children:[Object(K.jsx)(f.a.Item,{icon:Object(K.jsx)(te.a,{}),children:"Interfaces"},"interfaces"),Object(K.jsx)(f.a.Item,{icon:Object(K.jsx)(ne.a,{}),children:"Arp"},"arp"),Object(K.jsx)(f.a.Item,{icon:Object(K.jsx)(ae.a,{}),children:"VIP"},"vip"),Object(K.jsxs)(Ke,{icon:Object(K.jsx)(ie.a,{}),title:"Route",children:[Object(K.jsx)(f.a.Item,{children:"Static Route"},"s_route"),Object(K.jsx)(f.a.Item,{children:"Policy Route"},"p_route")]},"route"),Object(K.jsxs)(Ke,{icon:Object(K.jsx)(se.a,{}),title:"Policy",children:[Object(K.jsx)(f.a.Item,{children:"Nat"},"snat"),Object(K.jsx)(f.a.Item,{children:"Port map"},"dnat"),Object(K.jsx)(f.a.Item,{children:"Forward"},"filter")]},"policy"),Object(K.jsxs)(Ke,{icon:Object(K.jsx)(re.a,{}),title:"System",children:[Object(K.jsx)(f.a.Item,{children:"System"},"system"),Object(K.jsx)(f.a.Item,{children:"Black List"},"blacklist"),Object(K.jsx)(f.a.Item,{children:"White List"},"whitelist"),Object(K.jsx)(f.a.Item,{children:"User"},"user")]},"system_submenu")]})}),Object(K.jsx)(Ge,{style:{padding:"0 8px",minHeight:280},children:this.state.content})]})]})}}]),n}(c.Component),Je=n(566),Ye=n(567),Qe=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).getSessionData=function(){G.a.get(L.domain+"/api/serverInfo/getSysConnSessions").then((function(e){return a.setState({dataSource:e.data.data})})).catch((function(e){return m.b.error(e.response.data.detail)}))},a.columns=[{title:"Protocol",dataIndex:"protocol"},{title:"State",dataIndex:"tcp_flag"},{title:"TTL",dataIndex:"ttl"},{title:"Request",children:[{title:"Source",dataIndex:"req_src"},{title:"Destination",dataIndex:"req_dst"}]},{title:"Response",children:[{title:"Source",dataIndex:"rep_src"},{title:"Destination",dataIndex:"rep_dst"}]},{title:"Mark",dataIndex:"mark"}],a.state={dataSource:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getSessionData()}},{key:"render",value:function(){return Object(K.jsx)(T.a,{title:"Session List",children:Object(K.jsx)(he.a,{columns:this.columns,dataSource:this.state.dataSource,pagination:!1})})}}]),n}(c.Component),Ze=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).getRunningConfig=function(){G.a.get(L.domain+"/api/config/sys/getRunningConfig").then((function(e){return a.setState({data:e.data.data})}))},a.state={data:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getRunningConfig()}},{key:"render",value:function(){return Object(K.jsx)(T.a,{title:"Running Config",children:Object(K.jsx)("div",{children:this.state.data.map((function(e){return Object(K.jsx)("p",{children:e})}))})})}}]),n}(c.Component),Xe=b.a.Sider,$e=b.a.Content,et=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).handleMenuClick=function(e){switch(e.key){case"sessions":a.setState({content:Object(K.jsx)(Qe,{})});break;case"run_config":a.setState({content:Object(K.jsx)(Ze,{})})}},a.state={content:Object(K.jsx)(Qe,{})},a}return Object(h.a)(n,[{key:"render",value:function(){return Object(K.jsxs)(o.a.Fragment,{children:[Object(K.jsxs)(P.a,{style:{margin:"16px 0"},children:[Object(K.jsx)(P.a.Item,{children:"Home"}),Object(K.jsx)(P.a.Item,{children:"Report"})]}),Object(K.jsxs)(b.a,{className:"site-layout-background",style:{padding:"24px 0"},children:[Object(K.jsx)(Xe,{className:"site-layout-background",width:200,children:Object(K.jsxs)(f.a,{mode:"inline",defaultSelectedKeys:["event"],style:{height:"100%"},onClick:this.handleMenuClick,children:[Object(K.jsx)(f.a.Item,{icon:Object(K.jsx)(Je.a,{}),children:"Sessions"},"sessions"),Object(K.jsx)(f.a.Item,{icon:Object(K.jsx)(Ye.a,{}),children:"Configuration"},"run_config")]})}),Object(K.jsx)($e,{style:{padding:"0 8px",minHeight:280},children:this.state.content})]})]})}}]),n}(c.Component),tt=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).submit=function(){a.formRef.current.submit()},a.formRef=o.a.createRef(),a}return Object(h.a)(n,[{key:"render",value:function(){return Object(K.jsxs)(oe.a,{layout:"vertical",ref:this.formRef,onFinish:this.props.onFinish,children:[Object(K.jsx)(oe.a.Item,{name:"old_pwd",label:"Old Password",rules:[{required:!0,message:"Please input your old password!"}],hasFeedback:!0,children:Object(K.jsx)(de.a.Password,{placeholder:"old password"})}),Object(K.jsx)(oe.a.Item,{name:"pwd1",label:"New Password",rules:[{required:!0,message:"Please input your password!"}],hasFeedback:!0,children:Object(K.jsx)(de.a.Password,{placeholder:"new password"})}),Object(K.jsx)(oe.a.Item,{name:"pwd2",label:"Confirm Password",dependencies:["pwd1"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password!"},function(e){var t=e.getFieldValue;return{validator:function(e,n){return n&&t("pwd1")!==n?Promise.reject(new Error("The two passwords that you entered do not match!")):Promise.resolve()}}}],children:Object(K.jsx)(de.a.Password,{placeholder:"confirm password"})})]})}}]),n}(c.Component),nt=["title","titleId"];function at(){return(at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function it(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function st(e,t){var n=e.title,a=e.titleId,i=it(e,nt);return c.createElement("svg",at({t:1638858479414,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":1667,width:200,height:200,ref:t,"aria-labelledby":a},i),n?c.createElement("title",{id:a},n):null,Fe||(Fe=c.createElement("path",{d:"M512 15.573333C229.76 15.573333 0 243.072 0 523.093333c0 186.026667 100.608 347.904 251.562667 435.413334l32.853333-216.576A300.629333 300.629333 0 0 1 205.653333 540.586667c0-166.272 135.68-301.909333 304.213334-301.909334 168.448 0 304.042667 135.637333 304.042666 301.909334 0 78.805333-30.592 148.821333-78.762666 203.52l32.853333 216.661333c153.173333-87.509333 256-251.690667 256-437.674667C1024 243.072 794.24 15.573333 512 15.573333z m-2.133333 347.989334a161.536 161.536 0 0 0-161.962667 161.92 159.488 159.488 0 0 0 105.002667 151.04L389.546667 1009.066667h240.64l-61.226667-332.586667c59.093333-24.064 102.826667-80.981333 102.826667-150.997333a161.536 161.536 0 0 0-161.92-161.92z","p-id":1668})))}var rt=c.forwardRef(st),ct=(n.p,n(405)),ot=n(556),lt=n(568),dt=n(569),ut=n(570),ht={itemField:{display:"inline-block",fontWeight:"bolder",width:150,paddingRight:20,textAlign:"left",height:28},spin:{position:"absolute",left:0,top:"50%",right:0,bottom:"50%"}},jt=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).get_openvpn_server_status=function(){G.a.get(L.domain+"/api/apps/openvpn/getOpenVpnStatus").then((function(e){a.setState(e.data.data)}))},a.start_or_stop_server=function(e){if("start"===e||"stop"===e){var t=a.state;for(var n in t.status=e,t)if(void 0===t[n]||null===t[n]||0===t[n].length)return void m.b.error(n+" field is empty!");a.setState({loading:!0}),G.a.post(L.domain+"/api/apps/openvpn/startOrStopServer",t).then((function(e){m.b.success(e.data.msg),a.setState({loading:!1}),a.get_openvpn_server_status()})).catch((function(e){return m.b.error(e.response.data.detail)}))}else m.b.error("error command")},a.onFinish=function(e){a.setState({modal_spin:!0}),G.a.post(L.domain+"/api/apps/openvpn/genCert",e).then((function(e){m.b.success(e.data.msg),a.setState({visible:!1,modal_spin:!1})})).catch((function(e){m.b.error(e.response.data.detail),a.setState({modal_spin:!1})}))},a.formRef=o.a.createRef(),a.state={status:"",server:"",dns:"8.8.4.4",listen_port:1194,listen_ip:"10.10.0.1",loading:!1,modal_spin:!1,visible:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.get_openvpn_server_status()}},{key:"render",value:function(){var e=this;return Object(K.jsxs)(T.a,{title:"OpenVPN server status",children:[Object(K.jsxs)(ct.a,{spinning:this.state.loading,children:[Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:ht.itemField,children:"Status"}),Object(K.jsx)(ue.a,{status:"running"===this.state.status?"success":"error",text:this.state.status}),Object(K.jsx)(O.a,{type:"link",onClick:function(){return e.start_or_stop_server("running"===e.state.status?"stop":"start")},children:"running"===this.state.status?"stop":"start"}),Object(K.jsx)(O.a,{type:"primary",shape:"circle",style:{float:"right"},disabled:"running"===this.state.status,onClick:function(){return e.setState({visible:!0})},icon:Object(K.jsx)(lt.a,{})})]}),"running"===this.state.status?Object(K.jsxs)("div",{children:[Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:ht.itemField,children:"Protocol"}),"udp"]}),Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:ht.itemField,children:"Listen IP"}),this.state.listen_ip]}),Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:ht.itemField,children:"Listen Port"}),this.state.listen_port]}),Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:ht.itemField,children:"Server Network"}),this.state.server]}),Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:ht.itemField,children:"Dns Address"}),this.state.dns]})]}):Object(K.jsxs)("div",{children:[Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:ht.itemField,children:"Listen IP"}),Object(K.jsx)(de.a,{style:{width:200},value:this.state.listen_ip,onChange:function(t){return e.setState({listen_ip:t.target.value})}})]}),Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:ht.itemField,children:"Listen Port"}),Object(K.jsx)(de.a,{style:{width:200},value:this.state.listen_port,onChange:function(t){return e.setState({listen_port:1*t.target.value})}})]}),Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:ht.itemField,children:"Server Subnet"}),Object(K.jsx)(de.a,{style:{width:400},value:this.state.server,placeholder:"10.88.0.0/24",onChange:function(t){return e.setState({server:t.target.value})}})]}),Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{style:ht.itemField,children:"Dns Address"}),Object(K.jsx)(de.a,{style:{width:400},value:this.state.dns,placeholder:"8.8.8.8",onChange:function(t){return e.setState({dns:t.target.value})}})]})]})]}),Object(K.jsx)(y.a,{destroyOnClose:!0,title:"generate certification",visible:this.state.visible,onOk:function(){return e.formRef.current.submit()},onCancel:function(){return e.setState({visible:!1,modal_spin:!1})},children:Object(K.jsx)(ct.a,{spinning:this.state.modal_spin,children:Object(K.jsxs)(oe.a,{ref:this.formRef,onFinish:this.onFinish,layout:"vertical",children:[Object(K.jsx)(oe.a.Item,{name:"country",label:"Country",rules:[{required:!0,max:2,message:"please input country"}],children:Object(K.jsx)(de.a,{placeholder:"CN",max:2})}),Object(K.jsx)(oe.a.Item,{name:"province",label:"Province",rules:[{required:!0,max:4,message:"please input province"}],children:Object(K.jsx)(de.a,{placeholder:"HN",max:4})}),Object(K.jsx)(oe.a.Item,{name:"city",label:"City",rules:[{required:!0,max:10,message:"please input city name"}],children:Object(K.jsx)(de.a,{placeholder:"YiYang",max:10})}),Object(K.jsx)(oe.a.Item,{name:"org",label:"Organization",rules:[{required:!0,max:20,message:"please input Organization name"}],children:Object(K.jsx)(de.a,{placeholder:"FuRong Cloud",max:20})}),Object(K.jsx)(oe.a.Item,{name:"org_unit",label:"Organization Unit",rules:[{required:!0,max:20,message:"please input Organization unit"}],children:Object(K.jsx)(de.a,{placeholder:"It",max:20})}),Object(K.jsx)(oe.a.Item,{name:"email",label:"E-mail",rules:[{type:"email",required:!0,max:50,message:"please input email"}],children:Object(K.jsx)(de.a,{placeholder:"a@b.com",max:50})}),Object(K.jsx)(ot.a,{type:"warning",message:"Generate Certification will delete all exists user!!!"})]})})})]})}}]),n}(c.Component),pt=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).openvpn_users_columns=[{title:"Username",dataIndex:"username"},{title:"Name",dataIndex:"name"},{title:"User Ip",dataIndex:"user_ip"},{title:"Create Time",dataIndex:"join_date"},{title:"Operate",dataIndex:"id",render:function(e,t){return Object(K.jsxs)(je.b,{children:[Object(K.jsx)(O.a,{icon:Object(K.jsx)(dt.a,{}),onClick:function(){return window.open(L.domain+"/api/apps/openvpn/ovpnDownload/"+e+"/")},children:"ovpn"}),Object(K.jsx)(O.a,{icon:Object(K.jsx)(be.a,{}),onClick:function(){return a.delete_user(e)},children:"delete"}),Object(K.jsx)(O.a,{icon:Object(K.jsx)(ut.a,{}),onClick:function(){return a.setState({user_ip:t.user_ip,user_route:t.user_route,change_user_info_box:!0,user_id:t.id})},children:"Modify"})]})}}],a.modify_user_info=function(e){e.uid=a.state.user_id,G.a.put(L.domain+"/api/apps/openvpn/openVpnUserSet",e).then((function(e){m.b.success("success"),a.get_openvpn_users_list(a.state.pageInfo.current),a.setState({change_user_info_box:!1})})).catch((function(e){return m.b.error(e.response.data.detail)}))},a.get_openvpn_users_list=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;G.a.get(L.domain+"/api/apps/openvpn/openVpnUserSet",{params:{page:e}}).then((function(e){a.setState({dataSource:e.data.data})})).catch((function(e){return m.b.error(e.response.data.detail)}))},a.delete_user=function(e){a.setState({loading:!0}),y.a.confirm({title:"warnning",content:"Are you sure you want to delete this user",onCancel:function(){return a.setState({loading:!1})},onOk:function(){G.a.delete(L.domain+"/api/apps/openvpn/openVpnUserSet",{params:{uid:e}}).then((function(e){m.b.success(e.data.msg),a.setState({loading:!1}),a.get_openvpn_users_list(a.state.pageInfo.current)}))}})},a.onFinish=function(e){a.setState({loading:!0}),G.a.post(L.domain+"/api/apps/openvpn/openVpnUserSet",e).then((function(e){m.b.success(e.data.msg),a.setState({visible:!1,loading:!1}),a.get_openvpn_users_list(a.state.pageInfo.current)})).catch((function(e){return m.b.error(e.response.data.detail)}))},a.formRef=o.a.createRef(),a.userInfoFormRef=o.a.createRef(),a.state={dataSource:[],pageInfo:{current:1,pageSize:10,total:0},visible:!1,loading:!1,change_user_info_box:!1,user_ip:null,user_route:null,user_id:0},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.get_openvpn_users_list()}},{key:"render",value:function(){var e=this;return Object(K.jsxs)(o.a.Fragment,{children:[Object(K.jsxs)(T.a,{title:"OpenVPN Users",children:[Object(K.jsx)(O.a,{type:"primary",style:{marginBottom:15},icon:Object(K.jsx)(me.a,{}),onClick:function(){return e.setState({visible:!0})},children:"Add Openvpn User"}),Object(K.jsx)(ct.a,{spinning:this.state.loading,children:Object(K.jsx)(he.a,{columns:this.openvpn_users_columns,dataSource:this.state.dataSource,rowKey:"id",pagination:{current:this.state.pageInfo.current,total:this.state.pageInfo.total,pageSize:this.state.pageInfo.pageSize,onChange:function(t,n){return e.get_openvpn_users_list(t)}},expandable:{expandedRowRender:function(e){return Object(K.jsx)("div",{style:{margin:0},dangerouslySetInnerHTML:{__html:"<b>Client pushed routes</b></br>"+e.user_route.replaceAll(/\n/g,"</br>")}})}}})})]}),Object(K.jsx)(y.a,{destroyOnClose:!0,title:"add openvpn user",visible:this.state.visible,onOk:function(){return e.formRef.current.submit()},onCancel:function(){return e.setState({visible:!1})},children:Object(K.jsxs)(oe.a,{ref:this.formRef,onFinish:this.onFinish,layout:"vertical",children:[Object(K.jsx)(oe.a.Item,{name:"name",label:"Name",rules:[{required:!0,max:6,message:"please input a name"}],children:Object(K.jsx)(de.a,{placeholder:"Alice",max:6})}),Object(K.jsx)(oe.a.Item,{name:"username",label:"Username",rules:[{required:!0,max:20,message:"please input a username"}],children:Object(K.jsx)(de.a,{placeholder:"username",max:20})}),Object(K.jsx)(oe.a.Item,{name:"user_ip",label:"User Static Ip Address",rules:[{required:!0,max:20,message:"please input a private ip address"}],children:Object(K.jsx)(de.a,{placeholder:"10.0.88.1",max:15})}),Object(K.jsx)(oe.a.Item,{name:"user_route",label:"Push routes ",rules:[{required:!0,max:500,message:"please input route record"}],children:Object(K.jsx)(de.a.TextArea,{placeholder:"192.168.100.0 255.255.255.0"})})]})}),Object(K.jsx)(y.a,{destroyOnClose:!0,title:"Modify user ip route",visible:this.state.change_user_info_box,onOk:function(){return e.userInfoFormRef.current.submit()},onCancel:function(){return e.setState({change_user_info_box:!1})},children:Object(K.jsxs)(oe.a,{ref:this.userInfoFormRef,onFinish:this.modify_user_info,layout:"vertical",initialValues:{user_ip:this.state.user_ip,user_route:this.state.user_route},children:[Object(K.jsx)(oe.a.Item,{name:"user_ip",label:"User Static Ip Address",rules:[{required:!0,max:20,message:"please input a private ip address"}],children:Object(K.jsx)(de.a,{placeholder:"10.0.88.1",max:15})}),Object(K.jsx)(oe.a.Item,{name:"user_route",label:"Push routes ",rules:[{required:!0,max:500,message:"please input route record"}],children:Object(K.jsx)(de.a.TextArea,{placeholder:"192.168.100.0 255.255.255.0"})})]})})]})}}]),n}(c.Component),bt=b.a.Sider,mt=b.a.Content,ft=f.a.SubMenu,Ot=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).handleMenuClick=function(e){switch(e.key){case"openvpn_status":a.setState({content:Object(K.jsx)(jt,{})});break;case"openvpn_users":a.setState({content:Object(K.jsx)(pt,{})})}},a.state={content:Object(K.jsx)(jt,{})},a}return Object(h.a)(n,[{key:"render",value:function(){return Object(K.jsxs)(o.a.Fragment,{children:[Object(K.jsxs)(P.a,{style:{margin:"16px 0"},children:[Object(K.jsx)(P.a.Item,{children:"Home"}),Object(K.jsx)(P.a.Item,{children:"App"})]}),Object(K.jsxs)(b.a,{className:"site-layout-background",style:{padding:"24px 0"},children:[Object(K.jsx)(bt,{className:"site-layout-background",width:200,children:Object(K.jsx)(f.a,{mode:"inline",defaultSelectedKeys:["openvpn_status"],defaultOpenKeys:["openvpn"],style:{height:"100%"},onClick:this.handleMenuClick,children:Object(K.jsxs)(ft,{icon:Object(K.jsx)(rt,{width:18,fill:"#666"}),title:"OpenVPN",children:[Object(K.jsx)(f.a.Item,{children:"Status"},"openvpn_status"),Object(K.jsx)(f.a.Item,{children:"User"},"openvpn_users")]},"openvpn")})}),Object(K.jsx)(mt,{style:{padding:"0 8px",minHeight:280},children:this.state.content})]})]})}}]),n}(c.Component),xt=b.a.Header,gt=b.a.Content,vt=b.a.Footer;var yt=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).menu=Object(K.jsxs)(f.a,{children:[Object(K.jsx)(f.a.Item,{children:Object(K.jsx)(O.a,{style:{color:"black"},type:"link",icon:Object(K.jsx)(w.a,{}),onClick:function(){return a.setState({visible:!0,modal_title:"Change Password",modal_content:Object(K.jsx)(tt,{ref:a.Child,onFinish:a.handleChangePasswordFinish})})},children:"Change Password"})},"chang_password"),Object(K.jsx)(f.a.Item,{children:Object(K.jsx)(O.a,{style:{color:"black"},type:"link",icon:Object(K.jsx)(R.a,{}),onClick:function(){G.a.get(L.domain+"/api/config/sys/saveRunningConfig").then((function(){return m.b.success("success")})).catch((function(){return m.b.error("save cofnig failed!")}))},children:"Save Configuration"})},"save"),Object(K.jsx)(f.a.Item,{children:Object(K.jsx)(O.a,{style:{color:"black"},type:"link",icon:Object(K.jsx)(D.a,{}),onClick:function(){return window.sessionStorage.setItem("user_info",null),void window.location.reload()},children:"Logout"})},"logout")]}),a.handleChangePasswordFinish=function(e){console.log(e)},a.pageChange=function(e){switch(e.key){case"dashboard":a.setState({content:Object(K.jsx)(ee,{})});break;case"config":a.setState({content:Object(K.jsx)(We,{})});break;case"report":a.setState({content:Object(K.jsx)(et,{})});break;case"app":a.setState({content:Object(K.jsx)(Ot,{})})}},a.Child=o.a.createRef(),a.state={content:Object(K.jsx)(ee,{}),visible:!1,modal_title:null,modal_content:null},a}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return Object(K.jsxs)(b.a,{children:[Object(K.jsx)(xt,{className:"header",children:Object(K.jsxs)(x.a,{children:[Object(K.jsxs)(g.a,{span:20,children:[Object(K.jsx)(k,{stroke:"white",height:40,width:40,style:{marginTop:14,marginRight:20,float:"left"}}),Object(K.jsx)("div",{style:{float:"left",width:0,height:40,overflow:"hidden",margin:"13px 0",borderRight:"0.5px solid #666",borderLeft:"0.5px solid #000"},children:" "}),Object(K.jsx)("div",{style:{color:"white",float:"left",margin:"0 20px",fontSize:16,fontWeight:"bolder"},children:"FuRong Cloud FW"}),Object(K.jsxs)(f.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:["dashboard"],onClick:this.pageChange,children:[Object(K.jsx)(f.a.Item,{children:"Dashboard"},"dashboard"),Object(K.jsx)(f.a.Item,{children:"Config"},"config"),Object(K.jsx)(f.a.Item,{children:"Apps"},"app"),Object(K.jsx)(f.a.Item,{children:"Report"},"report")]})]}),Object(K.jsx)(g.a,{span:4,children:Object(K.jsx)(v.a,{overlay:this.menu,trigger:["click"],children:Object(K.jsxs)("a",{href:"#",style:{float:"right",color:"#fff"},className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()},children:[L.userData.first_name," ",Object(K.jsx)(A.a,{})]})})})]})}),Object(K.jsxs)(gt,{style:{padding:"0 50px",minHeight:document.documentElement.clientHeight-134},children:[this.state.content,Object(K.jsx)(y.a,{destroyOnClose:!0,tile:"Change Password",visible:this.state.visible,onCancel:function(){return e.setState({visible:!1,modal_title:null,modal_content:null})},onOk:function(){return e.Child.current.submit()},title:this.state.modal_title,children:this.state.modal_content})]}),Object(K.jsx)(vt,{style:{textAlign:"center"},children:"FuRong Cloud Data Center Design \xa92021 Created by Ant UED"})]})}}]),n}(c.Component),_t=n(574),It=n(575),St=n(576),Ct={bg:{position:"absolute",width:"100%",height:"100%",padding:0,margin:0,top:0,bottom:0,background:"#00032c url("+(n.p+"static/media/bg.20139654.jpg")+") no-repeat center center",backgroundSize:"100% 100%"},box:{position:"absolute",top:0,right:0,bottom:0,left:0,height:495,width:800,margin:"auto",overflow:"hidden"},left:{float:"left",width:350,height:"100%",backgroundColor:"#fff",padding:"100px 20px"},right:{float:"left",width:450,height:"100%",background:"#ffffff url("+(n.p+"static/media/ad.2d77ba1d.png")+") no-repeat center center",backgroundSize:"cover"},title:{fontWeight:"bolder",color:"#00032c",textAlign:"center",fontSize:20,margin:"20px 0"}},kt=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).onFinish=function(e){G.a.post(L.domain+"/api/user/login",e).then((function(e){m.b.success("login success"),window.sessionStorage.setItem("user_info",JSON.stringify(e.data.data)),window.location.reload()})).catch((function(e){m.b.error(e.response.data.detail);var t=Date.now(),n=Math.floor(t/1e3);a.setState({verification_img_url:a.basic_url+"?ts="+n})}))},a.basic_url=L.domain+"/api/common/img_verification_code",a.state={verification_img_url:a.basic_url},a}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return Object(K.jsx)("div",{style:Ct.bg,children:Object(K.jsxs)("div",{style:Ct.box,children:[Object(K.jsxs)("div",{style:Ct.left,children:[Object(K.jsx)("p",{style:Ct.title,children:"User Login"}),Object(K.jsxs)(oe.a,{layout:"vertical",onFinish:this.onFinish,children:[Object(K.jsx)(oe.a.Item,{name:"username",rules:[{required:!0,message:"please input username",max:20}],children:Object(K.jsx)(de.a,{prefix:Object(K.jsx)(_t.a,{}),placeholder:"Username"})}),Object(K.jsx)(oe.a.Item,{name:"password",rules:[{required:!0,message:"please input username",max:30}],children:Object(K.jsx)(de.a,{prefix:Object(K.jsx)(It.a,{}),type:"password",placeholder:"Password"})}),Object(K.jsx)(oe.a.Item,{name:"verify_code",rules:[{required:!0,message:"please input verification code",max:5}],children:Object(K.jsxs)(x.a,{gutter:8,children:[Object(K.jsx)(g.a,{span:15,children:Object(K.jsx)(de.a,{style:{marginTop:2},prefix:Object(K.jsx)(St.a,{}),placeholder:"Verification"})}),Object(K.jsx)(g.a,{children:Object(K.jsx)("img",{alt:"verification code",width:110,src:this.state.verification_img_url,onClick:function(t){var n=Date.now(),a=Math.floor(n/1e3);t.target.src=e.basic_url+"?ts="+a}})})]})}),Object(K.jsx)(O.a,{type:"primary",htmlType:"submit",children:"Login"})]})]}),Object(K.jsx)("div",{style:Ct.right})]})})}}]),n}(c.Component);d.a.render(L.userData?Object(K.jsx)(yt,{}):Object(K.jsx)(kt,{}),document.getElementById("root"))}},[[538,1,2]]]);
//# sourceMappingURL=main.7100d4ad.chunk.js.map